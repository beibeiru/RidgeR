---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# RidgeR: Ridge Regression with Significance Testing

## Installation

To install `RidgeR`, we recommend using `devtools`:

``` r
# install.packages("devtools")
devtools::install_github("beibeiru/RidgeR")
```

**System Requirements:** GNU Scientific Library (GSL)

The package has been installed successfully on Operating Systems:

* Red Hat Enterprise Linux 8.10 (Ootpa)
* macOS Sequoia 15.3.1
* Windows 10

## Functions

| Function | Description |
|----------|-------------|
| `SecAct.inference.gsl.old` | Single-threaded ridge regression (legacy `.C` interface, 32-bit indexing) |
| `SecAct.inference.gsl.new` | Multi-threaded ridge regression (`.Call` interface, 64-bit indexing) |

### Key Parameters

| Parameter | Default | Description |
|-----------|---------|-------------|
| `Y` | â€” | Gene expression matrix (genes x samples) |
| `SigMat` | `"SecAct"` | Signature matrix: `"SecAct"` (bundled) or path to file |
| `lambda` | `5e+05` | Ridge regularization parameter |
| `nrand` | `1000` | Number of permutations |
| `ncores` | `NULL` | Number of CPU cores (`NULL` = auto-detect; `SecAct.inference.gsl.new` only) |
| `rng_method` | `"srand"` | RNG backend: `"srand"` (C stdlib, matches R SecAct) or `"gsl"` (cross-platform GSL MT19937) |
| `is.group.sig` | `TRUE` | Group correlated signatures before regression |
| `is.group.cor` | `0.9` | Correlation threshold for signature grouping |

## Example

``` r
library(RidgeR)

dataPath <- file.path(system.file(package = "RidgeR"), "extdata/")
expr.diff <- read.table(paste0(dataPath, "Ly86-Fc_vs_Vehicle_logFC.txt"))

# Compare single-threaded and multi-threaded
t_old <- system.time({res.old <- SecAct.inference.gsl.old(expr.diff)})
t_new <- system.time({res.new <- SecAct.inference.gsl.new(expr.diff)})
print(t_old); print(t_new)

head(res.old$zscore)
head(res.new$zscore)
```

## Reproducibility

RidgeR supports two RNG backends via the `rng_method` parameter:

| `rng_method` | Description | Use case |
|---|---|---|
| `"srand"` (default) | C stdlib `srand()`/`rand()` | Match original R SecAct results **on the same platform** |
| `"gsl"` | GSL Mersenne Twister (MT19937) | **Cross-platform** reproducibility; matches [SecActPy](https://github.com/data2intelligence/SecActpy) `rng_method='gsl'` |

``` r
# Default: match R SecAct on same platform (C stdlib rand, platform-dependent)
res <- SecAct.inference.gsl.new(expr.diff, rng_method = "srand")

# Cross-platform: matches SecActPy rng_method='gsl' on any OS
res <- SecAct.inference.gsl.new(expr.diff, rng_method = "gsl")
```

> **Note:** C `rand()` implementations differ across operating systems, so
> `rng_method="srand"` produces platform-dependent results. Use
> `rng_method="gsl"` when results must be reproducible across Linux, macOS,
> and Windows, or when comparing with
> [SecActPy](https://github.com/data2intelligence/SecActpy).

